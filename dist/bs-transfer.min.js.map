{"version":3,"file":"bs-transfer.min.js","sources":["../src/options.js","../src/functions.js","../src/BsTransfer.js"],"sourcesContent":["export default {\n    tableOptions: {\n        classes: 'table table-bordered table-condensed table-hover',\n        escape: true,\n        clickToSelect: true,\n        search: true,\n        showSearchButton: true,\n        sidePagination: 'server',\n    },\n    upperOptions: {},\n    lowerOptions: {},\n};","import $ from 'jquery';\r\nimport options from './options';\r\nimport template from './template.html';\r\nimport styles from './styles.css';\r\n\r\n\r\n/**\r\n * 初始化选项\r\n * @param {BsTransfer} instance\r\n * @param {object} opts\r\n */\r\nexport function initOptions(instance, opts) {\r\n    opts = $.extend(true, {}, options, opts);\r\n    opts.upperOptions = $.extend(true, {}, opts.tableOptions, opts.upperOptions);\r\n    opts.lowerOptions = $.extend(true, {}, opts.tableOptions, opts.lowerOptions);\r\n    if (!opts.upperOptions.toolbar) {\r\n        opts.upperOptions.toolbar = $('<b>可选</b>')[0];\r\n    }\r\n    if (!opts.lowerOptions.toolbar) {\r\n        opts.lowerOptions.toolbar = $('<b>已选</b>')[0];\r\n    }\r\n    instance.options = opts;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 DOM\r\n * @param {BsTransfer} instance\r\n * @param {string} id\r\n */\r\nexport function initDOM(instance, id) {\r\n    const html = template.replace(/ID/g, id);\r\n    instance.$dom = $(html);\r\n    instance.$upper = instance.$dom.find(`.${id}__upper`);\r\n    instance.$lower = instance.$dom.find(`.${id}__lower`);\r\n    instance.$upperTable = instance.$upper.children('table');\r\n    instance.$lowerTable = instance.$lower.children('table');\r\n\r\n    // 初始化表格\r\n    const opts = instance.options;\r\n    instance.$upperTable.bootstrapTable(opts.upperOptions);\r\n    instance.$lowerTable.bootstrapTable(opts.lowerOptions);\r\n\r\n    // 监听按钮点击事件\r\n    const $middle = instance.$dom.find(`.${id}__middle`);\r\n    if (typeof opts.toUpper === 'function') {\r\n        $middle.find('button:first').click(opts.toUpper);\r\n    }\r\n    if (typeof opts.toLower === 'function') {\r\n        $middle.find('button:last').click(opts.toLower);\r\n    }\r\n\r\n    // 挂载\r\n    const $el = $(opts.mountPoint);\r\n    instance.$dom.addClass($el.attr('class'));\r\n    $el.replaceWith(instance.$dom);\r\n\r\n    $(window).resize(rafThrottle(_ => instance.adjustHeight()));\r\n    waitForRender(_ => instance.adjustHeight());\r\n}\r\n\r\n\r\n/**\r\n * 利用`requestAnimationFrame`进行节流\r\n * @param {function} fn\r\n * @returns {function}\r\n */\r\nfunction rafThrottle(fn) {\r\n    let token = 0;\r\n    return function () {\r\n        if (token) return;\r\n        token = 1;      // 取得令牌\r\n        const ctx = this;\r\n        const args = arguments;\r\n        requestAnimationFrame(function () {\r\n            fn.apply(ctx, args);\r\n            token = 0;  // 释放令牌\r\n        });\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * 等待渲染\r\n * @param {function} fn \r\n */\r\nexport function waitForRender(fn) {\r\n    if (Promise) {\r\n        Promise.resolve().then(fn)\r\n    } else {\r\n        setTimeout(fn);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 增加样式\r\n * @param {string} id \r\n */\r\nexport function appendStyles(id) {\r\n    let html = `<style class=\"ID\" type=\"text/css\">${styles}</style>`;\r\n    html = html.replace(/ID/g, id);\r\n    $(document.body).append(html);\r\n}\r\n","import $ from 'jquery';\r\nimport options from './options';\r\nimport {appendStyles, initOptions, initDOM, waitForRender} from './functions';\r\n\r\n\r\nexport default class BsTransfer {\r\n    static id = 'BS_TRANSFER';\r\n    static defaultOptions = options;\r\n\r\n\r\n    options;\r\n    $dom;\r\n    $upper;\r\n    $lower;\r\n    $upperTable;\r\n    $lowerTable;\r\n\r\n\r\n    constructor(opts) {\r\n        if (!$(`style.${BsTransfer.id}`).length) {\r\n            appendStyles(BsTransfer.id);         // 添加样式\r\n        }\r\n        initOptions(this, opts);\r\n        initDOM(this, BsTransfer.id);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用上层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    upperTable(...args) {\r\n        return this.$upperTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用下层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    lowerTable(...args) {\r\n        return this.$lowerTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 同时调用俩个表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    twoTables(...args) {\r\n        this.$upperTable.bootstrapTable(...args);\r\n        this.$lowerTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调整高度\r\n     */\r\n    adjustHeight() {\r\n        const height = this.$upper.height();\r\n        this.twoTables('resetView', {height});\r\n    }\r\n}\r\n"],"names":["tableOptions","classes","escape","clickToSelect","search","showSearchButton","sidePagination","upperOptions","lowerOptions","initDOM","instance","id","html","replace","$dom","$","$upper","find","$lower","$upperTable","children","$lowerTable","opts","options","bootstrapTable","$middle","toUpper","click","toLower","fn","token","$el","mountPoint","addClass","attr","replaceWith","window","resize","_","adjustHeight","ctx","this","args","arguments","requestAnimationFrame","apply","waitForRender","Promise","resolve","then","setTimeout","BsTransfer","length","document","body","append","extend","toolbar","initOptions","afterRender","height","twoTables"],"mappings":";;;;;;;6kBAAe,CACXA,aAAc,CACVC,QAAS,mDACTC,QAAQ,EACRC,eAAe,EACfC,QAAQ,EACRC,kBAAkB,EAClBC,eAAgB,UAEpBC,aAAc,GACdC,aAAc,ICoBX,SAASC,EAAQC,EAAUC,OACxBC,qdAAgBC,QAAQ,MAAOF,GACrCD,EAASI,KAAOC,EAAEH,GAClBF,EAASM,OAASN,EAASI,KAAKG,gBAASN,cACzCD,EAASQ,OAASR,EAASI,KAAKG,gBAASN,cACzCD,EAASS,YAAcT,EAASM,OAAOI,SAAS,SAChDV,EAASW,YAAcX,EAASQ,OAAOE,SAAS,aAG1CE,EAAOZ,EAASa,QACtBb,EAASS,YAAYK,eAAeF,EAAKf,cACzCG,EAASW,YAAYG,eAAeF,EAAKd,kBAGnCiB,EAAUf,EAASI,KAAKG,gBAASN,eACX,mBAAjBW,EAAKI,SACZD,EAAQR,KAAK,gBAAgBU,MAAML,EAAKI,SAEhB,mBAAjBJ,EAAKM,SACZH,EAAQR,KAAK,eAAeU,MAAML,EAAKM,aAkB1BC,EACbC,EAfEC,EAAMhB,EAAEO,EAAKU,YACnBtB,EAASI,KAAKmB,SAASF,EAAIG,KAAK,UAChCH,EAAII,YAAYzB,EAASI,MAEzBC,EAAEqB,QAAQC,QAUOR,EAVY,SAAAS,UAAK5B,EAAS6B,gBAWvCT,EAAQ,EACL,eACCA,GACJA,EAAQ,MACFU,EAAMC,KACNC,EAAOC,UACbC,uBAAsB,WAClBf,EAAGgB,MAAML,EAAKE,GACdZ,EAAQ,SAlBhBgB,GAAc,SAAAR,UAAK5B,EAAS6B,kBA4BzB,SAASO,EAAcjB,GACtBkB,QACAA,QAAQC,UAAUC,KAAKpB,GAEvBqB,WAAWrB,OCrFEsB,wBAaL7B,GDiFT,IAAsBX,EACrBC,iQCjFKG,kBAAWoC,EAAWxC,KAAMyC,SDgFZzC,EC/EJwC,EAAWxC,GDiFhCC,GADIA,smBACQC,QAAQ,MAAOF,GAC3BI,EAAEsC,SAASC,MAAMC,OAAO3C,IA3FrB,SAAqBF,EAAUY,IAClCA,EAAOP,EAAEyC,QAAO,EAAM,GAAIjC,EAASD,IAC9Bf,aAAeQ,EAAEyC,QAAO,EAAM,GAAIlC,EAAKtB,aAAcsB,EAAKf,cAC/De,EAAKd,aAAeO,EAAEyC,QAAO,EAAM,GAAIlC,EAAKtB,aAAcsB,EAAKd,cAC1Dc,EAAKf,aAAakD,UACnBnC,EAAKf,aAAakD,QAAU1C,EAAE,aAAa,IAE1CO,EAAKd,aAAaiD,UACnBnC,EAAKd,aAAaiD,QAAU1C,EAAE,aAAa,IAE/CL,EAASa,QAAUD,ECCfoC,CAAYjB,KAAMnB,GAClBb,EAAQgC,KAAMU,EAAWxC,IACO,mBAArBW,EAAKqC,aACZb,EAAcxB,EAAKqC,6FAUXxC,aAAYK,2FASZH,aAAYG,sFASnBL,aAAYK,0CACZH,aAAYG,6EAQXoC,EAASnB,KAAKzB,OAAO4C,cACtBC,UAAU,YAAa,CAACD,OAAAA,kDA1DhBT,OACL,iBADKA,mBAEO5B"}