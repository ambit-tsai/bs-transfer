{"version":3,"file":"bs-transfer.min.js","sources":["../src/options.js","../src/functions.js","../src/BsTransfer.js"],"sourcesContent":["export default {\n    tableOptions: {\n        classes: 'table table-bordered table-condensed table-hover',\n        escape: true,\n        clickToSelect: true,\n        search: true,\n        showSearchButton: true,\n    },\n    upperOptions: {},\n    lowerOptions: {},\n};","import options from './options';\r\nimport template from './template.html';\r\n\r\n\r\n/**\r\n * 初始化选项\r\n * @param {BsTransfer} instance\r\n * @param {object} opts\r\n */\r\nexport function initOptions(instance, opts) {\r\n    opts = $.extend(true, {}, options, opts);\r\n    opts.upperOptions = $.extend(true, {}, opts.tableOptions, opts.upperOptions);\r\n    opts.lowerOptions = $.extend(true, {}, opts.tableOptions, opts.lowerOptions);\r\n    if (!opts.upperOptions.toolbar) {\r\n        opts.upperOptions.toolbar = $('<b>可选</b>')[0];\r\n    }\r\n    if (!opts.lowerOptions.toolbar) {\r\n        opts.lowerOptions.toolbar = $('<b>已选</b>')[0];\r\n    }\r\n    instance.options = opts;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 DOM\r\n * @param {BsTransfer} instance\r\n * @param {string} id\r\n */\r\nexport function initDOM(instance, id) {\r\n    const html = template.replace(/ID/g, id);\r\n    instance.$dom = $(html);\r\n    instance.$upper = instance.$dom.find(`.${id}__upper`);\r\n    instance.$lower = instance.$dom.find(`.${id}__lower`);\r\n    instance.$upperTable = instance.$upper.children('table');\r\n    instance.$lowerTable = instance.$lower.children('table');\r\n\r\n    // 初始化表格\r\n    const opts = instance.options;\r\n    instance.$upperTable.bootstrapTable(opts.upperOptions);\r\n    instance.$lowerTable.bootstrapTable(opts.lowerOptions);\r\n\r\n    // 监听按钮点击事件\r\n    const $middle = instance.$dom.find(`.${id}__middle`);\r\n    if (typeof opts.toUpper === 'function') {\r\n        $middle.find('button:first').click(opts.toUpper);\r\n    }\r\n    if (typeof opts.toLower === 'function') {\r\n        $middle.find('button:last').click(opts.toLower);\r\n    }\r\n\r\n    // 挂载\r\n    const $el = $(opts.mountPoint);\r\n    instance.$dom.addClass($el.attr('class'));\r\n    $el.replaceWith(instance.$dom);\r\n\r\n    adjustHeight(instance);\r\n    $(window).resize(rafThrottle(_ => adjustHeight(instance)));\r\n}\r\n\r\n\r\n/**\r\n * 利用`requestAnimationFrame`进行节流\r\n * @param {function} fn\r\n * @returns {function}\r\n */\r\nfunction rafThrottle(fn) {\r\n    let token = 0;\r\n    return function () {\r\n        if (token) return;\r\n        token = 1;      // 取得令牌\r\n        const ctx = this;\r\n        const args = arguments;\r\n        requestAnimationFrame(function () {\r\n            fn.apply(ctx, args);\r\n            token = 0;  // 释放令牌\r\n        });\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * 调整高度\r\n * @param {BsTransfer} instance\r\n */\r\nfunction adjustHeight(instance) {\r\n    const height = instance.$upper.height();\r\n    instance.$upperTable.bootstrapTable('resetView', {height});\r\n    instance.$lowerTable.bootstrapTable('resetView', {height});\r\n}","import options from './options';\r\nimport {initOptions, initDOM} from './functions';\r\n\r\n\r\nexport default class BsTransfer {\r\n    static id = 'BS_TRANSFER';\r\n    static defaultOptions = options;\r\n\r\n\r\n    options;\r\n    $dom;\r\n    $upper;\r\n    $lower;\r\n    $upperTable;\r\n    $lowerTable;\r\n\r\n\r\n    constructor(options) {\r\n        initOptions(this, options);\r\n        initDOM(this, BsTransfer.id);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用上层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    upperTable(...args) {\r\n        return this.$upperTable.bootstrapTable(args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用下层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    lowerTable(...args) {\r\n        return this.$lowerTable.bootstrapTable(args);\r\n    }\r\n}\r\n"],"names":["tableOptions","classes","escape","clickToSelect","search","showSearchButton","upperOptions","lowerOptions","initOptions","instance","opts","$","extend","options","toolbar","initDOM","id","html","replace","$dom","$upper","find","$lower","$upperTable","children","$lowerTable","bootstrapTable","$middle","toUpper","click","toLower","fn","token","$el","mountPoint","addClass","attr","replaceWith","adjustHeight","window","resize","_","ctx","this","args","arguments","requestAnimationFrame","apply","height","BsTransfer"],"mappings":"qeAAe,CACXA,aAAc,CACVC,QAAS,mDACTC,QAAQ,EACRC,eAAe,EACfC,QAAQ,EACRC,kBAAkB,GAEtBC,aAAc,GACdC,aAAc,ICAX,SAASC,EAAYC,EAAUC,IAClCA,EAAOC,EAAEC,QAAO,EAAM,GAAIC,EAASH,IAC9BJ,aAAeK,EAAEC,QAAO,EAAM,GAAIF,EAAKV,aAAcU,EAAKJ,cAC/DI,EAAKH,aAAeI,EAAEC,QAAO,EAAM,GAAIF,EAAKV,aAAcU,EAAKH,cAC1DG,EAAKJ,aAAaQ,UACnBJ,EAAKJ,aAAaQ,QAAUH,EAAE,aAAa,IAE1CD,EAAKH,aAAaO,UACnBJ,EAAKH,aAAaO,QAAUH,EAAE,aAAa,IAE/CF,EAASI,QAAUH,EAShB,SAASK,EAAQN,EAAUO,OACxBC,4wCAAgBC,QAAQ,MAAOF,GACrCP,EAASU,KAAOR,EAAEM,GAClBR,EAASW,OAASX,EAASU,KAAKE,gBAASL,cACzCP,EAASa,OAASb,EAASU,KAAKE,gBAASL,cACzCP,EAASc,YAAcd,EAASW,OAAOI,SAAS,SAChDf,EAASgB,YAAchB,EAASa,OAAOE,SAAS,aAG1Cd,EAAOD,EAASI,QACtBJ,EAASc,YAAYG,eAAehB,EAAKJ,cACzCG,EAASgB,YAAYC,eAAehB,EAAKH,kBAGnCoB,EAAUlB,EAASU,KAAKE,gBAASL,eACX,mBAAjBN,EAAKkB,SACZD,EAAQN,KAAK,gBAAgBQ,MAAMnB,EAAKkB,SAEhB,mBAAjBlB,EAAKoB,SACZH,EAAQN,KAAK,eAAeQ,MAAMnB,EAAKoB,aAkB1BC,EACbC,EAfEC,EAAMtB,EAAED,EAAKwB,YACnBzB,EAASU,KAAKgB,SAASF,EAAIG,KAAK,UAChCH,EAAII,YAAY5B,EAASU,MAEzBmB,EAAa7B,GACbE,EAAE4B,QAAQC,QASOT,EATY,SAAAU,UAAKH,EAAa7B,IAU3CuB,EAAQ,EACL,eACCA,GACJA,EAAQ,MACFU,EAAMC,KACNC,EAAOC,UACbC,uBAAsB,WAClBf,EAAGgB,MAAML,EAAKE,GACdZ,EAAQ,SAUpB,SAASM,EAAa7B,OACZuC,EAASvC,EAASW,OAAO4B,SAC/BvC,EAASc,YAAYG,eAAe,YAAa,CAACsB,OAAAA,IAClDvC,EAASgB,YAAYC,eAAe,YAAa,CAACsB,OAAAA,QCnFjCC,wBAaLpC,kQACRL,EAAYmC,KAAM9B,GAClBE,EAAQ4B,KAAMM,EAAWjC,2FAQf4B,2BAAAA,yBACHD,KAAKpB,YAAYG,eAAekB,mEAQ7BA,2BAAAA,yBACHD,KAAKlB,YAAYC,eAAekB,iDAjC1BK,OACL,iBADKA,mBAEOpC"}