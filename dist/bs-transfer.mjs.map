{"version":3,"file":"bs-transfer.mjs","sources":["../src/options.js","../src/functions.js","../src/BsTransfer.js"],"sourcesContent":["export default {\n    tableOptions: {\n        classes: 'table table-bordered table-condensed table-hover',\n        escape: true,\n        clickToSelect: true,\n        search: true,\n        showSearchButton: true,\n        sidePagination: 'server',\n    },\n    upperOptions: {},\n    lowerOptions: {},\n};","import $ from 'jquery';\r\nimport options from './options';\r\nimport template from './template.html';\r\nimport styles from './styles.css';\r\n\r\n\r\n/**\r\n * 初始化选项\r\n * @param {BsTransfer} instance\r\n * @param {object} opts\r\n */\r\nexport function initOptions(instance, opts) {\r\n    opts = $.extend(true, {}, options, opts);\r\n    opts.upperOptions = $.extend(true, {}, opts.tableOptions, opts.upperOptions);\r\n    opts.lowerOptions = $.extend(true, {}, opts.tableOptions, opts.lowerOptions);\r\n    if (!opts.upperOptions.toolbar) {\r\n        opts.upperOptions.toolbar = $('<b>可选</b>')[0];\r\n    }\r\n    if (!opts.lowerOptions.toolbar) {\r\n        opts.lowerOptions.toolbar = $('<b>已选</b>')[0];\r\n    }\r\n    instance.options = opts;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 DOM\r\n * @param {BsTransfer} instance\r\n * @param {string} id\r\n */\r\nexport function initDOM(instance, id) {\r\n    const html = template.replace(/ID/g, id);\r\n    instance.$dom = $(html);\r\n    instance.$upper = instance.$dom.find(`.${id}__upper`);\r\n    instance.$lower = instance.$dom.find(`.${id}__lower`);\r\n    instance.$upperTable = instance.$upper.children('table');\r\n    instance.$lowerTable = instance.$lower.children('table');\r\n\r\n    // 初始化表格\r\n    const opts = instance.options;\r\n    instance.$upperTable.bootstrapTable(opts.upperOptions);\r\n    instance.$lowerTable.bootstrapTable(opts.lowerOptions);\r\n\r\n    // 监听按钮点击事件\r\n    const $middle = instance.$dom.find(`.${id}__middle`);\r\n    if (typeof opts.toUpper === 'function') {\r\n        $middle.find('button:first').click(opts.toUpper);\r\n    }\r\n    if (typeof opts.toLower === 'function') {\r\n        $middle.find('button:last').click(opts.toLower);\r\n    }\r\n\r\n    // 挂载\r\n    const $el = $(opts.mountPoint);\r\n    instance.$dom.addClass($el.attr('class'));\r\n    $el.replaceWith(instance.$dom);\r\n\r\n    $(window).resize(rafThrottle(_ => instance.adjustHeight()));\r\n    waitForRender(_ => instance.adjustHeight());\r\n}\r\n\r\n\r\n/**\r\n * 利用`requestAnimationFrame`进行节流\r\n * @param {function} fn\r\n * @returns {function}\r\n */\r\nfunction rafThrottle(fn) {\r\n    let token = 0;\r\n    return function () {\r\n        if (token) return;\r\n        token = 1;      // 取得令牌\r\n        const ctx = this;\r\n        const args = arguments;\r\n        requestAnimationFrame(function () {\r\n            fn.apply(ctx, args);\r\n            token = 0;  // 释放令牌\r\n        });\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * 等待渲染\r\n * @param {function} fn \r\n */\r\nexport function waitForRender(fn) {\r\n    if (Promise) {\r\n        Promise.resolve().then(fn)\r\n    } else {\r\n        setTimeout(fn);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 增加样式\r\n * @param {string} id \r\n */\r\nexport function appendStyles(id) {\r\n    let html = `<style class=\"ID\" type=\"text/css\">${styles}</style>`;\r\n    html = html.replace(/ID/g, id);\r\n    $(document.body).append(html);\r\n}\r\n","import $ from 'jquery';\r\nimport options from './options';\r\nimport {appendStyles, initOptions, initDOM, waitForRender} from './functions';\r\n\r\n\r\nexport default class BsTransfer {\r\n    static id = 'BS_TRANSFER';\r\n    static defaultOptions = options;\r\n\r\n\r\n    options;\r\n    $dom;\r\n    $upper;\r\n    $lower;\r\n    $upperTable;\r\n    $lowerTable;\r\n\r\n\r\n    constructor(opts) {\r\n        if (!$(`style.${BsTransfer.id}`).length) {\r\n            appendStyles(BsTransfer.id);         // 添加样式\r\n        }\r\n        initOptions(this, opts);\r\n        initDOM(this, BsTransfer.id);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用上层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    upperTable(...args) {\r\n        return this.$upperTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调用下层表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    lowerTable(...args) {\r\n        return this.$lowerTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 同时调用俩个表格的方法\r\n     * @param  {...any} args \r\n     */\r\n    twoTables(...args) {\r\n        this.$upperTable.bootstrapTable(...args);\r\n        this.$lowerTable.bootstrapTable(...args);\r\n    }\r\n\r\n\r\n    /**\r\n     * 调整高度\r\n     */\r\n    adjustHeight() {\r\n        const height = this.$upper.height();\r\n        this.twoTables('resetView', {height});\r\n    }\r\n}\r\n"],"names":["tableOptions","classes","escape","clickToSelect","search","showSearchButton","sidePagination","upperOptions","lowerOptions","initOptions","instance","opts","$","extend","options","toolbar","initDOM","id","html","template","replace","$dom","$upper","find","$lower","$upperTable","children","$lowerTable","bootstrapTable","$middle","toUpper","click","toLower","$el","mountPoint","addClass","attr","replaceWith","window","resize","rafThrottle","_","adjustHeight","waitForRender","fn","token","ctx","args","arguments","requestAnimationFrame","apply","Promise","resolve","then","setTimeout","appendStyles","styles","document","body","append","BsTransfer","constructor","length","afterRender","upperTable","lowerTable","twoTables","height"],"mappings":"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"}